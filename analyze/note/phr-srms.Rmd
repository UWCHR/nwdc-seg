---
title: "Data on Solitary Confinement at the Northwest Detention Center"
author: "UWCHR"
date: "2024-03-14"
output:
    html_document:
        html_preview: true
        toc: true
        toc_depth: 3
        toc_float: true
        code_folding: hide
---

# Data source

This dataset of ICE Segregation Review Management System (SRMS) records from September 1, 2018 through September 1, 2018 was released pursuant to a FOIA request by Harvard Law School and published as [replication data](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/AT7YFA) for the report ['“Endless Nightmare” Torture and Inhuman Treatment in Solitary Confinement in U.S. Immigration Detention'](https://phr.org/our-work/resources/endless-nightmare-solitary-confinement-in-us-immigration-detention) by Harvard Immigration and Refugee Clinical Program (HIRCP) and Arevik Avedian at Harvard Law School (HLS), Peeler Immigration Lab (PIL) at Harvard Medical School (HMS), and Physicians for Human Rights (PHR).

## Notebook goal

This notebook focuses on analysis of ICE Segregation Review Management System (SRMS) records reported by the Northwest ICE Processing Center in Tacoma, WA; also known as the Northwest Detention Center (NWDC), and coded as "TACOMA ICE PROCESSING CENTER (NORTHWEST DET CTR) (WA)" in the below data. Given that this analysis was conducted in response to a breaking news event, it may be updated to reflect ongoing analysis.

```{r import_data, message = FALSE, warning = FALSE}

library(pacman)
p_load(tidyverse, arrow, lubridate, zoo, digest, ggplot2, plotly, gghighlight, viridis)

df <- read_delim(here::here('analyze', 'input', 'SRMS_spreadsheet_9.1.2018_-_9.1.2023_Redacted.csv.gz'), delim='|',
                      col_types = cols('Placement Date' = col_date(format="%m/%d/%Y"),
                                       'Release Date' = col_date(format="%m/%d/%Y"))) %>% 
  drop_na('Tracking Number', 'Facility AOR')

names(df) %<>% stringr::str_replace_all("\\s","_") %>% tolower

nwdc_det_trinidad <- read_delim(here::here('analyze', 'frozen', 'nwdc_trinidad_and_tobago_fy11-24ytd.csv.gz'), delim = "|",
                            col_types = cols(stay_book_in_date_time = col_datetime(format=''),
                                             stay_book_out_date_time = col_datetime(format=''),
                                             detention_book_in_date_and_time = col_datetime(format=''),
                                             detention_book_out_date_time = col_datetime(format='')
                                             ))

nwdc <- "TACOMA ICE PROCESSING CENTER (NORTHWEST DET CTR) (WA)"

# Checking for any variation in SEA AOR facility names; NWDC should be only one present
stopifnot(length(unique(df[df$facility_aor == "SEA (Seattle)", "facility"])) == 1)

# Data cleaning per `dataverse_files/analysis/data_prep.do`
df <- df %>% 
  mutate(mental_illness = case_when(mental_illness == "Yes" ~ "Mental Illness",
                                    TRUE ~ mental_illness),
         facility = case_when(facility == "WEBB COUNTY DETENTION CENTER (TX)" ~ "WEBB COUNTY DETENTION CENTER (CCA) (TX)",
                              TRUE ~ facility))



```

# Data overview

The HLS/PHR dataset includes a total of `r nrow(df)` SMRS placement records for `r length(unique(df$facility))` U.S. ICE detention facilities. For a full description of the dataset, see the [full report](https://phr.org/our-work/resources/endless-nightmare-solitary-confinement-in-us-immigration-detention).

The dataset includes a total of `r nrow(df %>% filter(facility == nwdc))` SRMS placement records for the Northwest Detention Center (NWDC) in Tacoma, WA; including `r nrow(df %>% filter(facility == nwdc, is.na(release_date)))` solitary placements that were ongoing at the time of release of the dataset. These ongoing solitary placements are included in this analysis.

## Death of Charles Leo Daniel at NWDC

On March 7, 2024, the death of Charles Leo Daniel was reported at Northwest Detention Center (NWDC). Daniel, a citizen of Trinidad and Tobago, was reportedly in segregation at the time of his death. ICE detention records processed in a separate repository show that Daniel was booked in to the NWDC on April 2, 2020, and that he was the only citizen of Trinidad and Tobago to be detained at the facility from his arrival in 2020 until August 15, 2022 (see `analyze/frozen/nwdc_trinidad_and_tobago_fy11-24ytd.csv.gz`). 

Therefore, we conclude that the two ICE SRMS records in the dataset for a male citizen of Trinidad and Tobago at NWDC represent Daniel's segregation history while detained at the facility. The full records are presented below (note redaction of some values):

```{r nwdc_seg_trinidad, message = FALSE, warning = FALSE}

nwdc_seg_trin <- df %>% 
  filter(str_detect(facility, "TACOMA"),
         country_of_citizenship == 'TRINIDAD AND TOBAGO') %>% 
  mutate(placement_date = as.character(placement_date),
         release_date = as.character(release_date))

transpose_df <- function(df) {
  t_df <- data.table::transpose(df)
  colnames(t_df) <- rownames(df)
  rownames(t_df) <- colnames(df)
  t_df <- t_df %>%
    tibble::rownames_to_column(.data = .) %>%
    tibble::as_tibble(.)
  return(t_df)
}

knitr::kable(transpose_df(nwdc_seg_trin) %>% 
               rename(column = rowname,
                      placement_1 = "1",
                      placement_2 = "2"),
             caption = "NWDC SRMS records for citizens of Trinindad and Tobago")

```

The first solitary placement began on `r nwdc_seg_trin$placement_date[1]`, shortly after Daniel was booked into the NWDC and lasted until `r nwdc_seg_trin$release_date[1]`, or `r nwdc_seg_trin$length_of_stay[1]` days. The second solitary placement began two days later on `r nwdc_seg_trin$placement_date[2]` and was ongoing at the time of release of the HLS data in mid-September 2023, or at least `r nwdc_seg_trin$length_of_stay[2]` days. (As noted in the replication data for the HLS/PHR report, ongoing solitary placements were dropped from analysis for the published report; we include these records here due to their relevance to issues at the NWDC.)

As noted, both stays were reported by ICE as "Detainee Request", with the second stay categorized as "Protective Custody". Both stays are also flagged as "Serious Mental Illness".

As seen below, Daniel's second placement of at least `r nwdc_seg_trin$length_of_stay[2]` days was the second longest individual solitary placement reported nationally during the time period covered by the HLS dataset. As seen below, the longest individual placement reported nationally was also at NWDC and was also ongoing at the time of release of the dataset. (Because unique personal identifiers are not included in this dataset, it is not possible to calculate cumulative stay length per person across individual solitary placements.)

```{r placemnent_length_natl, message = FALSE, warning = FALSE}

t1 <- df %>% 
  mutate(ongoing_stay = is.na(release_date)) %>% 
  arrange(desc(length_of_stay)) %>% 
  head(10) %>% 
  mutate(length_of_stay = case_when(ongoing_stay == TRUE ~ paste0(as.character(length_of_stay), "+"),
                                    TRUE ~ as.character(length_of_stay))) %>% 
  dplyr::select(country_of_citizenship, facility, length_of_stay, mental_illness) %>% 
  knitr::kable(caption = "Top 10 longest solitary placements nationwide, Sept. 2018-Sept. 2023",
               row.names = TRUE)

t1

p1 <- df %>% 
  dplyr::select(country_of_citizenship, facility, length_of_stay) %>% 
  arrange(desc(length_of_stay)) %>% 
  mutate(rank = row_number()) %>% 
  head(10) %>% 
  ggplot(aes(x=as.factor(rank), y=length_of_stay, fill=facility)) +
  geom_col() +
  # scale_x_discrete(limits=rev) +
  scale_fill_viridis_d(direction=-1, breaks=rev) +
  # gghighlight(facility == nwdc) +
  labs(title = "Top 10 longest solitary placements nationwide, Sept. 2018-Sept. 2023",
       fill = "Facility") +
  ylab("Length of placement (Days)") +
  xlab("") +
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.direction = 'vertical')

p1

```

## Comparison of solitary placement lengths

In fact, solitary placements reported to SRMS at the Northwest ICE Process Center were significantly longer on average than nationally, with an average stay length of `r round(mean(df[df$facility == nwdc,]$length_of_stay), 2)` days compared to a national average of `r round(mean(df$length_of_stay), 2)` days, and a median stay length of `r round(median(df[df$facility == nwdc,]$length_of_stay), 2)` days compared to a national median of `r round(median(df$length_of_stay), 2)` days:

```{r compare_all, message = FALSE, warning = FALSE}

df_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  mutate(group = "NWDC")

df_all <- df %>% 
  mutate(group = "Nat'l")

dat <- rbind(df_nwdc, df_all) %>% 
  mutate(group = as.factor(group))

b1 <- dat %>% 
  group_by(group) %>% 
  ggplot(aes(x = group, y = log(length_of_stay), fill=group)) +
  geom_boxplot() +
  scale_fill_viridis_d(direction=-1, breaks=rev) +
  scale_x_discrete() +
  theme_minimal() +
  labs(title = "Distribution of solitary placement lengths",
       subtitle = "National versus NWDC")

b1

```

## Special vulnerabilities

SRMS placements are flagged for "special vulnerability" categories, noted in the dataset as "Mental Illness", "Serious Medical Illness", "Serious Disability", and "Suicide Risk?". The following charts and plots summarize the proportion of SRMS records flagged for these categories at NWDC versus nationally; as well as distributions of placement length for each category at NWDC versus nationally. We note that in almost all categories, solitary placements at NWDC tend to be longer than for the same categories nationwide.

### Mental illness

```{r mental_illness_prop}

mi_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  count(mental_illness) %>% 
  mutate(prop = n / sum(n)) %>% 
  ungroup()

mi_natl <- df %>%
  count(mental_illness) %>% 
  mutate(prop = n / sum(n)) %>% 
  ungroup()

dat <- left_join(mi_natl, mi_nwdc, by='mental_illness', suffix=c(".natl", ".nwdc")) %>% 
  pivot_longer(cols=-c('mental_illness')) %>%
  filter(str_detect(name, "prop")) %>% 
  mutate(value = case_when(name == "prop.natl" ~ -value,
                   name == "prop.nwdc" ~ value))

mi_prop_range <- range(dat$value)
mi_prop_range_breaks <- pretty(dat$value, 10)

p1 <- dat %>% 
  ggplot(aes(x = value, y = mental_illness, fill=name), color = 'black') +
    geom_col() +
    scale_fill_viridis_d(limits=rev) +
    scale_y_discrete(limits=rev) +
    scale_x_continuous(
      breaks = mi_prop_range_breaks,
      labels = function(x) scales::percent(abs(x))) +
  labs(title = "Proportion of solitary placements",
       subtitle = "NWDC vs. national") +
  theme_minimal()

p1

```

```{r mental_illness_length}

df_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  mutate(group = "NWDC")

df_all <- df %>% 
  mutate(group = "Nat'l")

dat <- rbind(df_nwdc, df_all) %>% 
  mutate(group = as.factor(group))

b1 <- dat %>% 
  ggplot(aes(x = group, y = log(length_of_stay), fill = mental_illness)) +
  geom_boxplot() +
  scale_fill_viridis_d() +
  theme_minimal()

b1

```

### Serious medical illness

```{r medical_illness_length}

df_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  mutate(group = "NWDC")

df_all <- df %>% 
  mutate(group = "Nat'l")

dat <- rbind(df_nwdc, df_all) %>% 
  mutate(group = as.factor(group))

# dat %>% 
#   count(group, serious_medical_illness)

b1 <- dat %>% 
  ggplot(aes(x = group, y = log(length_of_stay), fill = serious_medical_illness) )+
  geom_boxplot() +
  scale_fill_viridis_d() +
  theme_minimal()

b1

```

### Serious disability

```{r serious_disability_length}

df_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  mutate(group = "NWDC")

df_all <- df %>% 
  mutate(group = "Nat'l")

dat <- rbind(df_nwdc, df_all) %>% 
  mutate(group = as.factor(group))

# dat %>% 
#   count(group, serious_disability)

b1 <- dat %>% 
  ggplot(aes(x = group, y = log(length_of_stay), fill = serious_disability) )+
  geom_boxplot() +
  scale_fill_viridis_d() +
  theme_minimal()

b1

```

## Detainee-requested versus Facility-initiated solitary placements

```{r detainee_request_prop}

dr_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  count(detainee_request_segregation) %>% 
  mutate(prop = n / sum(n)) %>% 
  ungroup()

dr_natl <- df %>%
  count(detainee_request_segregation) %>% 
  mutate(prop = n / sum(n)) %>% 
  ungroup()

dat <- left_join(dr_natl, dr_nwdc, by='detainee_request_segregation', suffix=c(".natl", ".nwdc")) %>% 
  pivot_longer(cols=-c('detainee_request_segregation')) %>%
  filter(str_detect(name, "prop")) %>% 
  mutate(value = case_when(name == "prop.natl" ~ -value,
                   name == "prop.nwdc" ~ value))

dr_prop_range <- range(dat$value)
dr_prop_range_breaks <- pretty(dat$value, 10)

p1 <- dat %>% 
  ggplot(aes(x = value, y = detainee_request_segregation, fill=name), color = 'black') +
    geom_col() +
    scale_fill_viridis_d(limits=rev) +
    scale_y_discrete(limits=rev) +
    scale_x_continuous(
      breaks = dr_prop_range_breaks,
      labels = function(x) scales::percent(abs(x))) +
  labs(title = "Proportion of solitary placements",
       subtitle = "NWDC vs. national") +
  theme_minimal()

p1

```

```{r detainee_request_length}

df_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  mutate(group = "NWDC")

df_all <- df %>% 
  mutate(group = "Nat'l")

dat <- rbind(df_nwdc, df_all) %>% 
  mutate(group = as.factor(group))

b1 <- dat %>% 
  ggplot(aes(x = group, y = log(length_of_stay), fill = detainee_request_segregation)) +
  geom_boxplot() +
  scale_fill_viridis_d() +
  theme_minimal()

b1

```

## Placement reason

Note no placements categorized as "Hunger Strike", "Mental Illness" (some "Medical/Mental"), or "Suicide Risk" at NWDC. Note several of these categories are not mutually-exclusive.

```{r placement_reason_length}

df <- df %>% 
  mutate(placement_reason_short = case_when(
    str_detect(placement_reason, "Detainee Request: Other") ~ "Detainee Request",
    str_detect(placement_reason, "Disciplinary") ~ "Disciplinary",
    str_detect(placement_reason, "Facility Initiated: Other") ~ "Facility Initiated",
    str_detect(placement_reason, "Facility Security Threat") ~ "Facility Initiated",
    str_detect(placement_reason, "Facility Security Threat: Due to Seriousness of Criminal Conviction") ~ "Facility Initiated",
    str_detect(placement_reason, "Facility Security Threat: Gang Member Status (Not Protective Custody)") ~ "Facility Initiated",
    str_detect(placement_reason, "Facility Security Threat: Other") ~ "Facility Initiated",
    str_detect(placement_reason, "Facility Security Threat: Violent or Disruptive Behavior") ~ "Facility Initiated",
    str_detect(placement_reason, "Hunger Strike") ~ "Hunger Strike",
    str_detect(placement_reason, "Medical/Mental") ~ "Medical/Mental",
    str_detect(placement_reason, "Medical: Detox/Withdrawal Observation") ~ "Medical",
    str_detect(placement_reason, "Medical: Disabled or Infirm") ~ "Medical",
    str_detect(placement_reason, "Medical: Observation") ~ "Medical",
    str_detect(placement_reason, "Medical: Other Infectious Disease") ~ "Medical",
    str_detect(placement_reason, "Medical: Other") ~ "Medical",
    str_detect(placement_reason, "Medical: Segregation Unit") ~ "Medical",
    str_detect(placement_reason, "Medical: Tuberculosis") ~ "Medical",
    str_detect(placement_reason, "Mental Illness") ~ "Mental Illness",
    str_detect(placement_reason, "Mental Illness: Observation") ~ "Mental Illness",
    str_detect(placement_reason, "Other") ~ "Other",
    str_detect(placement_reason, "Other: Pending General Population Bedspace Availability") ~ "Other",
    str_detect(placement_reason, "Other: Unique Reason Not Listed (Explain in Comments)") ~ "Other",
    str_detect(placement_reason, "Pending Investigation of Disciplinary Violation") ~ "Pending Disciplinary",
    str_detect(placement_reason, "Protective Custody") ~ "Protective Custody",
    str_detect(placement_reason, "Protective Custody: Criminal Offense (i.e. Sex Offender)") ~ "Protective Custody",
    str_detect(placement_reason, "Protective Custody: Gang Status (Protective Custody Only)") ~ "Protective Custody",
    str_detect(placement_reason, "Protective Custody: Lesbian, Gay, Bisexual, Transgender (LGBT)") ~ "Protective Custody",
    str_detect(placement_reason, "Protective Custody: Other Detainee Safety") ~ "Protective Custody",
    str_detect(placement_reason, "Protective Custody: Special Vulnerability Other") ~ "Protective Custody",
    str_detect(placement_reason, "Protective Custody: Victim of Sexual Assault") ~ "Protective Custody",
    str_detect(placement_reason, "Suicide Risk Placement") ~ "Suicide Risk"
  ))

df_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  mutate(group = "NWDC")

df_all <- df %>% 
  mutate(group = "Nat'l")

dat <- rbind(df_nwdc, df_all)

b1 <- dat %>% 
  ggplot(aes(y = placement_reason_short, x = log(length_of_stay), fill = group)) +
  geom_boxplot() +
  scale_fill_viridis_d(limits=rev) +
  theme_minimal()

b1
```

```{r placement_reason_prop}

dr_nwdc <- df %>% 
  filter(facility == nwdc) %>% 
  count(placement_reason_short) %>% 
  mutate(prop = n / sum(n)) %>% 
  ungroup()

dr_natl <- df %>%
  count(placement_reason_short) %>% 
  mutate(prop = n / sum(n)) %>% 
  ungroup()

dat <- left_join(dr_natl, dr_nwdc, by='placement_reason_short', suffix=c(".natl", ".nwdc")) %>% 
  pivot_longer(cols=-c('placement_reason_short')) %>%
  filter(str_detect(name, "prop")) %>% 
  mutate(value = case_when(name == "prop.natl" ~ -value,
                   name == "prop.nwdc" ~ value))

dr_prop_range <- range(dat$value)
dr_prop_range_breaks <- pretty(dat$value, 10)

p1 <- dat %>% 
  ggplot(aes(x = value, y = placement_reason_short, fill=name), color = 'black') +
    geom_col() +
    scale_fill_viridis_d(limits=rev) +
    scale_y_discrete(limits=rev) +
    scale_x_continuous(
      breaks = dr_prop_range_breaks,
      labels = function(x) scales::percent(abs(x))) +
  labs(title = "Proportion of solitary placements",
       subtitle = "NWDC vs. national") +
  theme_minimal()

p1

```
