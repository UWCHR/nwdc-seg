
<!DOCTYPE html>
<HTML>
<HEAD>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/LaTeX", "output/HTML-CSS"],
    "HTML-CSS": { availableFonts: ["TeX"] }
    });
</script>

<script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<style>

@font-face {
  font-family: 'Raleway';
  font-style: normal;
  font-weight: 300;
  src: local('Raleway Light'), local('Raleway-Light'), url(http://fonts.gstatic.com/s/raleway/v9/-_Ctzj9b56b8RgXW8FArifk_vArhqVIZ0nv9q090hN8.woff2) format('woff2');
}
@font-face {
  font-family: 'Raleway';
  font-style: normal;
  font-weight: 400;
  src: local('Raleway'), url(http://fonts.gstatic.com/s/raleway/v9/0dTEPzkLWceF7z0koJaX1A.woff2) format('woff2');
}
@font-face {
  font-family: 'Raleway';
  font-style: normal;
  font-weight: 600;
  src: local('Raleway SemiBold'), local('Raleway-SemiBold'), url(http://fonts.gstatic.com/s/raleway/v9/xkvoNo9fC8O2RDydKj12b_k_vArhqVIZ0nv9q090hN8.woff2) format('woff2');
}
html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit; /* 1 */
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box; /* 2 */
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}


/*
* Skeleton V2.0.4
* Copyright 2014, Dave Gamache
* www.getskeleton.com
* Free to use under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
* 12/29/2014
*/
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }
.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }
@media (min-width: 400px) {
  .container {
    width: 85%;
    padding: 0; }
}
@media (min-width: 550px) {
  .container {
    width: 80%; }
  .column,
  .columns {
    margin-left: 4%; }
  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns                    { width: 4.66666666667%; }
  .two.columns                    { width: 13.3333333333%; }
  .three.columns                  { width: 22%;            }
  .four.columns                   { width: 30.6666666667%; }
  .five.columns                   { width: 39.3333333333%; }
  .six.columns                    { width: 48%;            }
  .seven.columns                  { width: 56.6666666667%; }
  .eight.columns                  { width: 65.3333333333%; }
  .nine.columns                   { width: 74.0%;          }
  .ten.columns                    { width: 82.6666666667%; }
  .eleven.columns                 { width: 91.3333333333%; }
  .twelve.columns                 { width: 100%; margin-left: 0; }

  .one-third.column               { width: 30.6666666667%; }
  .two-thirds.column              { width: 65.3333333333%; }

  .one-half.column                { width: 48%; }

  /* Offsets */
  .offset-by-one.column,
  .offset-by-one.columns          { margin-left: 8.66666666667%; }
  .offset-by-two.column,
  .offset-by-two.columns          { margin-left: 17.3333333333%; }
  .offset-by-three.column,
  .offset-by-three.columns        { margin-left: 26%;            }
  .offset-by-four.column,
  .offset-by-four.columns         { margin-left: 34.6666666667%; }
  .offset-by-five.column,
  .offset-by-five.columns         { margin-left: 43.3333333333%; }
  .offset-by-six.column,
  .offset-by-six.columns          { margin-left: 52%;            }
  .offset-by-seven.column,
  .offset-by-seven.columns        { margin-left: 60.6666666667%; }
  .offset-by-eight.column,
  .offset-by-eight.columns        { margin-left: 69.3333333333%; }
  .offset-by-nine.column,
  .offset-by-nine.columns         { margin-left: 78.0%;          }
  .offset-by-ten.column,
  .offset-by-ten.columns          { margin-left: 86.6666666667%; }
  .offset-by-eleven.column,
  .offset-by-eleven.columns       { margin-left: 95.3333333333%; }

  .offset-by-one-third.column,
  .offset-by-one-third.columns    { margin-left: 34.6666666667%; }
  .offset-by-two-thirds.column,
  .offset-by-two-thirds.columns   { margin-left: 69.3333333333%; }

  .offset-by-one-half.column,
  .offset-by-one-half.columns     { margin-left: 52%; }

}
html {
  font-size: 62.5%; }
body {
  font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */
  line-height: 1.6;
  font-weight: 400;
  font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #222; }
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 2rem;
  font-weight: 300; }
h1 { font-size: 3.6rem; line-height: 1.2;  letter-spacing: -.1rem;}
h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; }
h3 { font-size: 3.2rem; line-height: 1.3;  letter-spacing: -.1rem; }
h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; }
h5 { font-size: 2.4rem; line-height: 1.5;  letter-spacing: -.05rem; }
h6 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }

p {
  margin-top: 0; }
a {
  color: #1EAEDB; }
a:hover {
  color: #0FA0CE; }
.button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
  display: inline-block;
  height: 38px;
  padding: 0 30px;
  color: #555;
  text-align: center;
  font-size: 11px;
  font-weight: 600;
  line-height: 38px;
  letter-spacing: .1rem;
  text-transform: uppercase;
  text-decoration: none;
  white-space: nowrap;
  background-color: transparent;
  border-radius: 4px;
  border: 1px solid #bbb;
  cursor: pointer;
  box-sizing: border-box; }
.button:hover,
button:hover,
input[type="submit"]:hover,
input[type="reset"]:hover,
input[type="button"]:hover,
.button:focus,
button:focus,
input[type="submit"]:focus,
input[type="reset"]:focus,
input[type="button"]:focus {
  color: #333;
  border-color: #888;
  outline: 0; }
.button.button-primary,
button.button-primary,
input[type="submit"].button-primary,
input[type="reset"].button-primary,
input[type="button"].button-primary {
  color: #FFF;
  background-color: #33C3F0;
  border-color: #33C3F0; }
.button.button-primary:hover,
button.button-primary:hover,
input[type="submit"].button-primary:hover,
input[type="reset"].button-primary:hover,
input[type="button"].button-primary:hover,
.button.button-primary:focus,
button.button-primary:focus,
input[type="submit"].button-primary:focus,
input[type="reset"].button-primary:focus,
input[type="button"].button-primary:focus {
  color: #FFF;
  background-color: #1EAEDB;
  border-color: #1EAEDB; }
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea,
select {
  height: 38px;
  padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
  background-color: #fff;
  border: 1px solid #D1D1D1;
  border-radius: 4px;
  box-shadow: none;
  box-sizing: border-box; }
/* Removes awkward default styles on some inputs for iOS */
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
textarea {
  min-height: 65px;
  padding-top: 6px;
  padding-bottom: 6px; }
input[type="email"]:focus,
input[type="number"]:focus,
input[type="search"]:focus,
input[type="text"]:focus,
input[type="tel"]:focus,
input[type="url"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
  border: 1px solid #33C3F0;
  outline: 0; }
label,
legend {
  display: block;
  margin-bottom: .5rem;
  font-weight: 600; }
fieldset {
  padding: 0;
  border-width: 0; }
input[type="checkbox"],
input[type="radio"] {
  display: inline; }
label > .label-body {
  display: inline-block;
  margin-left: .5rem;
  font-weight: normal; }
ul {
  list-style: circle inside; }
ol {
  list-style: decimal inside; }
ol, ul {
  padding-left: 0;
  margin-top: 0; }
ul ul,
ul ol,
ol ol,
ol ul {
  margin: 1.5rem 0 1.5rem 3rem;
  font-size: 90%; }
li {
  margin-bottom: 1rem; }
th,
td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #E1E1E1; }
th:first-child,
td:first-child {
  padding-left: 0; }
th:last-child,
td:last-child {
  padding-right: 0; }
button,
.button {
  margin-bottom: 1rem; }
input,
textarea,
select,
fieldset {
  margin-bottom: 1.5rem; }
pre,
blockquote,
dl,
figure,
table,
p,
ul,
ol,
form {
  margin-bottom: 2.5rem; }
.u-full-width {
  width: 100%;
  box-sizing: border-box; }
.u-max-full-width {
  max-width: 100%;
  box-sizing: border-box; }
.u-pull-right {
  float: right; }
.u-pull-left {
  float: left; }
hr {
  margin-top: 3rem;
  margin-bottom: 3.5rem;
  border-width: 0;
  border-top: 1px solid #E1E1E1; }
.container:after,
.row:after,
.u-cf {
  content: "";
  display: table;
  clear: both; }

pre {
  display: block;
  padding: 9.5px;
  margin: 0 0 10px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #333;
  word-break: break-all;
  word-wrap: break-word;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
}
code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 4px;
}

@media (min-width: 400px) {}
@media (min-width: 550px) {}
@media (min-width: 750px) {}
@media (min-width: 1000px) {}
@media (min-width: 1200px) {}

</style>

<style>
.hll { background-color: #ffffcc }
.c { color: #408080; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cp { color: #BC7A00 } /* Comment.Preproc */
.cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.c1 { color: #408080; font-style: italic } /* Comment.Single */
.cs { color: #408080; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #FF0000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #00A000 } /* Generic.Inserted */
.go { color: #888888 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0044DD } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #7D9029 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #999999; font-weight: bold } /* Name.Entity */
.ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #A0A000 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mb { color: #666666 } /* Literal.Number.Bin */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sa { color: #BA2121 } /* Literal.String.Affix */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.dl { color: #BA2121 } /* Literal.String.Delimiter */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #BB6688 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.fm { color: #0000FF } /* Name.Function.Magic */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.vm { color: #19177C } /* Name.Variable.Magic */
.il { color: #666666 } /* Literal.Number.Integer.Long */
</style>





<style>
h1.title {margin-top : 20px}
img {max-width : 100%}

#From nbconvert
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>

</HEAD>
<BODY>
    <div class ="container">
        <div class = "row">
            <div class = "col-md-12 twelve columns">




<h1>Use of Solitary Confinement at the Northwest Detention Center: Data Appendix</h1>
<h1>1. GEO Group Internal Datasets ("SMU", "RHU")</h1>
<h2>UW Center for Human Rights</h2>
<p><a href="index.html">Back to Data Appendix Index</a></p>
<p><strong>Data analyzed:</strong></p>
<p>1.1 - GEO Group Segregation Lieutenant's log of Restricted Housing Unit (<strong>"RHU"</strong>) placements at NWDC, released to UWCHR via FOIA litigation on August 12, 2020.
1.2 - GEOTrack report of Segregation Management Unit (<strong>"SMU"</strong>) housing assignments at NWDC, released to UWCHR via FOIA litigation on August 12, 2020.</p>

<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">yaml</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;input/cleanstats.yaml&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">yamlfile</span><span class="p">:</span>
    <span class="n">cur_yaml</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">yamlfile</span><span class="p">)</span>
    <span class="n">smu_cleanstats</span> <span class="o">=</span> <span class="n">cur_yaml</span><span class="p">[</span><span class="s1">&#39;output/smu.csv.gz&#39;</span><span class="p">]</span>
    <span class="n">rhu_cleanstats</span> <span class="o">=</span> <span class="n">cur_yaml</span><span class="p">[</span><span class="s1">&#39;output/rhu.csv.gz&#39;</span><span class="p">]</span>
</pre></div>

<h1>1.1 - GEOtrack report ("SMU")</h1>
<p>Original filename: <code>Sep_1_2013_to_March_31_2020_SMU_geotrack_report_Redacted.pdf</code></p>
<p>Described by US DOJ attorneys for ICE as follows:</p>
<blockquote>
<p>"The GEOtrack report that was provided to Plaintiffs runs from September 1, 2013 to March 31, 2020. That report not only reports all placements into segregation, but it also tracks movement. This means that if an individual is placed into one particular unit then simply moves to a different unit, it is tracked in that report (if an individual is moved from H unit cell 101 to H unit cell 102, it would reflect the move as a new placement on the report)."</p>
</blockquote>
<p>We refer to this dataset here by the shorthand "SMU" for "Special Management Unit".</p>
<p>The original file has been converted from PDF to CSV format using the <a href="https://www.xpdfreader.com/pdftotext-man.html">Xpdf pdftotext</a> command line tool with <code>--table</code> option, and hand cleaned to correct OCR errors. The resulting CSV has been minimally cleaned in a private repository, dropping 14 duplicated records and adding a unique identifier field, <code>hashid</code>; cleaning code available upon request.</p>
<p>The original file includes three redacted fields: <code>Alien #</code>, <code>Name</code>, and <code>Birthdate</code>. The file appears to be generated by a database report for the date range "9/1/2013 To 3/31/2020", presumably from the "GEOtrack" database referenced in the filename and by the DOJ attorneys for ICE. The original file has no un-redacted unique field identifiers or individual identifiers.</p>

<div class="highlight"><pre><span></span><span class="n">csv_opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sep&#39;</span><span class="p">:</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span>
            <span class="s1">&#39;quotechar&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
            <span class="s1">&#39;encoding&#39;</span><span class="p">:</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">}</span>

<span class="n">smu</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;input/smu.csv.gz&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">csv_opts</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;hashid&#39;</span><span class="p">]))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">smu</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;hashid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span>

<span class="n">data_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">smu</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">data_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;hashid&#39;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">smu</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 3433 entries, 0 to 3432
Data columns (total 10 columns):
 #   Column         Non-Null Count  Dtype
---  ------         --------------  -----
 0   citizenship    3433 non-null   object
 1   housing        3433 non-null   object
 2   assigned_dt    3433 non-null   object
 3   removed_dt     3433 non-null   object
 4   days_in_seg    3433 non-null   int64
 5   assigned_date  3433 non-null   object
 6   assigned_hour  3433 non-null   object
 7   removed_date   3433 non-null   object
 8   removed_hour   3433 non-null   object
 9   hashid         3433 non-null   object
dtypes: int64(1), object(9)
memory usage: 268.3+ KB
None
</pre></div>

<p>Here we display the first five records in the dataset (excluding <code>hashid</code> field):</p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>citizenship</th>
      <th>housing</th>
      <th>assigned_dt</th>
      <th>removed_dt</th>
      <th>days_in_seg</th>
      <th>assigned_date</th>
      <th>assigned_hour</th>
      <th>removed_date</th>
      <th>removed_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GUATEMALA</td>
      <td>H-NA-108</td>
      <td>6/27/2013 1:31:00AM</td>
      <td>4/9/2014 11:49:00PM</td>
      <td>286</td>
      <td>6/27/2013</td>
      <td>1:31:00AM</td>
      <td>4/9/2014</td>
      <td>11:49:00PM</td>
    </tr>
    <tr>
      <td>MEXICO</td>
      <td>H-NA-205</td>
      <td>8/5/2013 2:30:00PM</td>
      <td>11/10/2014 6:34:00AM</td>
      <td>462</td>
      <td>8/5/2013</td>
      <td>2:30:00PM</td>
      <td>11/10/2014</td>
      <td>6:34:00AM</td>
    </tr>
    <tr>
      <td>MEXICO</td>
      <td>H-NA-106</td>
      <td>8/8/2013 10:08:00AM</td>
      <td>9/6/2013 11:41:00AM</td>
      <td>29</td>
      <td>8/8/2013</td>
      <td>10:08:00AM</td>
      <td>9/6/2013</td>
      <td>11:41:00AM</td>
    </tr>
    <tr>
      <td>MARSHALL ISLANDS</td>
      <td>H-NA-203</td>
      <td>8/15/2013 11:17:00AM</td>
      <td>9/13/2013 9:05:00AM</td>
      <td>29</td>
      <td>8/15/2013</td>
      <td>11:17:00AM</td>
      <td>9/13/2013</td>
      <td>9:05:00AM</td>
    </tr>
    <tr>
      <td>MEXICO</td>
      <td>H-NA-209</td>
      <td>8/15/2013 10:07:00PM</td>
      <td>9/9/2013 12:00:00AM</td>
      <td>25</td>
      <td>8/15/2013</td>
      <td>10:07:00PM</td>
      <td>9/9/2013</td>
      <td>12:00:00AM</td>
    </tr>
  </tbody>
</table>

<div class="highlight"><pre><span></span><span class="c1"># All date fields convert successfully</span>

<span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;assigned_dt&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">smu</span><span class="p">[</span><span class="s1">&#39;assigned_dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;assigned_dt&#39;</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;removed_dt&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">smu</span><span class="p">[</span><span class="s1">&#39;removed_dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;removed_dt&#39;</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;assigned_date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">smu</span><span class="p">[</span><span class="s1">&#39;assigned_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;assigned_date&#39;</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;removed_date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">smu</span><span class="p">[</span><span class="s1">&#39;removed_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;removed_date&#39;</span><span class="p">])</span>
</pre></div>

<p>The GEOTrack database export time-frame conforms to <code>removed_dt</code> min/max values:</p>

<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;assigned_dt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;removed_dt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
count                    3433
unique                   3297
top       2020-02-28 04:29:00
freq                        3
first     2013-06-27 01:31:00
last      2020-03-31 18:28:00
Name: assigned_dt, dtype: object

count                    3433
unique                   3303
top       2020-03-31 12:00:00
freq                       17
first     2013-09-01 18:18:00
last      2020-03-31 12:00:00
Name: removed_dt, dtype: object
</pre></div>

<p>One record has a <code>removed_dt</code> value less than <code>assigned_dt</code>, but this is only a discrepancy in the hour values:</p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>citizenship</th>
      <th>housing</th>
      <th>assigned_dt</th>
      <th>removed_dt</th>
      <th>days_in_seg</th>
      <th>assigned_date</th>
      <th>assigned_hour</th>
      <th>removed_date</th>
      <th>removed_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MEXICO</td>
      <td>H-NA-110</td>
      <td>2020-03-31 18:28:00</td>
      <td>2020-03-31 12:00:00</td>
      <td>0</td>
      <td>2020-03-31</td>
      <td>6:28:00PM</td>
      <td>2020-03-31</td>
      <td>12:00:00PM</td>
    </tr>
  </tbody>
</table>

<p>81 records have a <code>removed_dt</code> value equal to <code>assigned_dt</code>, as seen in this sample of five records:</p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>citizenship</th>
      <th>housing</th>
      <th>assigned_dt</th>
      <th>removed_dt</th>
      <th>days_in_seg</th>
      <th>assigned_date</th>
      <th>assigned_hour</th>
      <th>removed_date</th>
      <th>removed_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MEXICO</td>
      <td>H-NA-209</td>
      <td>2013-09-22 03:25:00</td>
      <td>2013-09-22 03:25:00</td>
      <td>0</td>
      <td>2013-09-22</td>
      <td>3:25:00AM</td>
      <td>2013-09-22</td>
      <td>3:25:00AM</td>
    </tr>
    <tr>
      <td>MEXICO</td>
      <td>H-NA-209</td>
      <td>2013-09-22 03:29:00</td>
      <td>2013-09-22 03:29:00</td>
      <td>0</td>
      <td>2013-09-22</td>
      <td>3:29:00AM</td>
      <td>2013-09-22</td>
      <td>3:29:00AM</td>
    </tr>
    <tr>
      <td>UKRAINE</td>
      <td>H-NA-210</td>
      <td>2013-11-08 03:30:00</td>
      <td>2013-11-08 03:30:00</td>
      <td>0</td>
      <td>2013-11-08</td>
      <td>3:30:00AM</td>
      <td>2013-11-08</td>
      <td>3:30:00AM</td>
    </tr>
    <tr>
      <td>MOROCCO</td>
      <td>H-NA-103</td>
      <td>2013-11-29 02:11:00</td>
      <td>2013-11-29 02:11:00</td>
      <td>0</td>
      <td>2013-11-29</td>
      <td>2:11:00AM</td>
      <td>2013-11-29</td>
      <td>2:11:00AM</td>
    </tr>
    <tr>
      <td>LAOS</td>
      <td>H-NA-102</td>
      <td>2013-12-28 20:03:00</td>
      <td>2013-12-28 20:03:00</td>
      <td>0</td>
      <td>2013-12-28</td>
      <td>8:03:00PM</td>
      <td>2013-12-28</td>
      <td>8:03:00PM</td>
    </tr>
  </tbody>
</table>

<p>We retain these records despite the logical inconsistency of these datetime fields, under the assumption that they represent short placements of less than one full day.</p>
<p>Recalculating segregation placement length based on date only results in same value as <code>days_in_seg</code> field.</p>
<p>Note that this calculation is not first day inclusive, as in the case of the original version of the RHU dataset (see below). We will disregard hourly data for comparison purposes, as no other dataset includes hourly placement or release times.</p>

<div class="highlight"><pre><span></span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;days_calc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;removed_date&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">smu</span><span class="p">[</span><span class="s1">&#39;assigned_date&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;days_in_seg&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">smu</span><span class="p">[</span><span class="s1">&#39;days_calc&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">smu</span><span class="p">)</span>
</pre></div>

<p>The below desciptive statistics reflect first day exclusive stay lengths, including stays of 0 days. 547, or 15.93% of records reflect stay lengths of less than one day, based on placement dates. Note that placements in the SMU dataset represent specific housing assignments within one of 3433 cells in the segregation management unit, and would therefore be expected to reflect more and shorter placements than other datasets:</p>

<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;days_calc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
count    3433.000000
mean        9.976697
std        23.672531
min         0.000000
25%         1.000000
50%         3.000000
75%        10.000000
max       488.000000
Name: days_calc, dtype: float64
</pre></div>

<p>All housing assignments are represented during each year covered by the dataset, but usage patterns vary, with housing units in the 200 block associated with longer average placements:</p>

<div class="highlight"><pre><span></span><span class="n">smu_annual</span> <span class="o">=</span> <span class="n">smu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;assigned_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">)])</span>

<span class="n">housing_unit_count</span> <span class="o">=</span> <span class="n">smu_annual</span><span class="p">[</span><span class="s1">&#39;housing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="k">assert</span> <span class="nb">int</span><span class="p">(</span><span class="n">housing_unit_count</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">20</span>

<span class="k">print</span><span class="p">(</span><span class="n">smu</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;housing&#39;</span><span class="p">)[</span><span class="s1">&#39;days_calc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
housing
H-NA-101     5.921162
H-NA-102     6.841202
H-NA-103     6.396624
H-NA-104     5.917355
H-NA-105     7.285088
H-NA-106     8.342857
H-NA-107     7.387755
H-NA-108     8.229665
H-NA-109     6.763158
H-NA-110     7.327014
H-NA-201    14.446281
H-NA-202    14.398374
H-NA-203    13.976923
H-NA-204    14.376000
H-NA-205    41.538462
H-NA-206    21.675676
H-NA-207    20.444444
H-NA-208    12.503597
H-NA-209    13.992308
H-NA-210    11.358974
Name: days_calc, dtype: float64
</pre></div>

<p>Annual median and mean placement lengths show an increase during calendar years 2017-2018:</p>

<div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">smu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;assigned_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">)])</span>

<span class="n">smu_annual_med</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;days_calc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">smu_annual_avg</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;days_calc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">smu_annual_med</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">smu_annual_avg</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre>
assigned_date
2013-01-01    3.0
2014-01-01    3.0
2015-01-01    3.0
2016-01-01    3.0
2017-01-01    4.0
2018-01-01    5.0
2019-01-01    4.0
2020-01-01    2.0
Freq: AS-JAN, Name: days_calc, dtype: float64

assigned_date
2013-01-01    10.785185
2014-01-01     7.831721
2015-01-01     9.393814
2016-01-01     9.889693
2017-01-01    12.404537
2018-01-01    11.188940
2019-01-01     9.501969
2020-01-01     7.437956
Freq: AS-JAN, Name: days_calc, dtype: float64
</pre></div>

<p>Total placement counts per calendar year (note incomplete data for 2013, 2020):</p>

<div class="highlight"><pre><span></span><span class="n">smu_total_annual</span> <span class="o">=</span> <span class="n">smu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;assigned_dt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">)])[</span><span class="s1">&#39;hashid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">smu_total_annual</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre>
assigned_dt
2013-01-01    270
2014-01-01    517
2015-01-01    485
2016-01-01    553
2017-01-01    529
2018-01-01    434
2019-01-01    508
2020-01-01    137
Freq: AS-JAN, Name: hashid, dtype: int64
</pre></div>

<p>Stays over 14 days must be reported to ICE SRMS; here we flag long placements and calculate as a percent of total placements per year. Again note that placements are by housing assignment in one of 20 total housing locations, not cumulative stay length, so long stays may not be accurately represented here. The lack of unique identifiers makes it impossible to track cases of individuals in segregation for a total of 14 non-consecutive days during any 21 day period; or individuals with special vulnerabilities.</p>
<p>We find that long placements increase over time both absolutely and as proportion of total placements. However, this may simply reflect fewer transfers of individuals between housing assignments:</p>

<div class="highlight"><pre><span></span><span class="n">smu</span><span class="p">[</span><span class="s1">&#39;long_stay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">smu</span><span class="p">[</span><span class="s1">&#39;days_calc&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">14</span>
<span class="n">long_stays_annual</span> <span class="o">=</span> <span class="n">smu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;assigned_dt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">)])[</span><span class="s1">&#39;long_stay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">long_stays_annual</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">long_stays_annual</span> <span class="o">/</span> <span class="n">smu_total_annual</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre>
assigned_dt
2013-01-01     48.0
2014-01-01     66.0
2015-01-01     63.0
2016-01-01     85.0
2017-01-01     94.0
2018-01-01    105.0
2019-01-01    111.0
2020-01-01     26.0
Freq: AS-JAN, Name: long_stay, dtype: float64

assigned_dt
2013-01-01    0.177778
2014-01-01    0.127660
2015-01-01    0.129897
2016-01-01    0.153707
2017-01-01    0.177694
2018-01-01    0.241935
2019-01-01    0.218504
2020-01-01    0.189781
Freq: AS-JAN, dtype: float64
</pre></div>

<p>Top citizenship values:</p>

<p><strong>Table 1: SMU dataset top five countries of citizenship</strong></p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>citizenship</th>
      <th>placements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MEXICO</td>
      <td>1782</td>
    </tr>
    <tr>
      <td>EL SALVADOR</td>
      <td>189</td>
    </tr>
    <tr>
      <td>HONDURAS</td>
      <td>148</td>
    </tr>
    <tr>
      <td>GUATEMALA</td>
      <td>133</td>
    </tr>
    <tr>
      <td>CANADA</td>
      <td>95</td>
    </tr>
    <tr>
      <td>ALL OTHERS</td>
      <td>1086</td>
    </tr>
  </tbody>
</table>

<h3>Comparison with segregation placements reported by DHS inspectors</h3>
<p>A <a href="https://drive.google.com/file/d/1YDX4fOOJ3DCftWiQv7O_5jwA2eZ0ftWR/view?usp=sharing">June 24-26, 2014 DHS inspection report</a> for NWDC states, "Documentation reflects there were 776 assignments to segregation in the past year". The DHS inspection report does not specify the source of the records cited.</p>
<p>The SMU dataset covers this period, albeit with only partial records for June-Sept 2013. The total count of placements recorded in the SMU dataset during this period, 615 , is reasonably close to figure cited by DHS inspectors, which suggests an average of about 65.0 placements per month:</p>

<div class="highlight"><pre><span></span><span class="c1">### Monthly total placements during period of DHS inspection report:</span>

<span class="n">dhs_period</span> <span class="o">=</span> <span class="n">smu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;assigned_dt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;2014-06-30&#39;</span><span class="p">]</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">dhs_period</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="s1">&#39;hashid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>

<span class="n">dhs_period_complete</span> <span class="o">=</span> <span class="n">smu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;assigned_dt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2013-09-01&#39;</span><span class="p">:</span><span class="s1">&#39;2014-06-30&#39;</span><span class="p">]</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">dhs_period_complete</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">))</span>

<span class="n">dhs_period_complete_monthly_avg</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;hashid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

<div class="highlight"><pre>
assigned_dt
2013-06-30     1
2013-07-31     0
2013-08-31    14
2013-09-30    65
2013-10-31    56
2013-11-30    56
2013-12-31    78
2014-01-31    61
2014-02-28    55
2014-03-31    61
2014-04-30    63
2014-05-31    48
2014-06-30    57
Freq: M, Name: hashid, dtype: int64
</pre></div>

<p>This is comparable to the average of 60.0 placements per month reported in the SMU dataset during the period for which complete data exists (September 2013 - June 2014). If the GEOtrack database is the source of the data cited in the 2014 DHS inspection report, this is not noted in the inspection report itself.</p>
<h1>1.2 - GEO Lieutenant's report ("RHU")</h1>
<p>Original file: <code>15_16_17_18_19_20_RHU_admission_Redacted.xlsx</code></p>
<p>Log created and maintained by hand by GEO employee to track Restricted Housing Unit placements. Described by US DOJ attorneys for ICE as follows:</p>
<blockquote>
<p>"The spreadsheet runs from January 2015 to May 28, 2020 and was created by and for a lieutenant within the facility once he took over the segregation lieutenant duties. The spreadsheet is updated once a detainee departs segregation. The subjects who are included on this list, therefore, are those who were placed into segregation and have already been released from segregation. It does not include those individuals who are currently in segregation."</p>
</blockquote>
<p>We refer to this dataset here by the shorthand "RHU" for "Restricted Housing Unit".<a href="#_ftn1" name="_ftnref1"><sup>[1]</sup></a></p>
<p>The original file has been converted from XLSX to CSV format, with each annual tab saved as a separate CSV. The resulting CSVs have been concatenated and minimally cleaned in a private repository, dropping 75 duplicated records and adding a unique identifier field, <code>hashid</code>; cleaning code availabe upon request.</p>
<p>The original file includes two fully redacted fields: <code>Name</code> and <code>Alien #</code>; and one partially redacted field, <code>Placement reason</code>. The original file has no un-redacted unique field identifiers or individual identifiers.</p>

<div class="highlight"><pre><span></span><span class="n">csv_opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sep&#39;</span><span class="p">:</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span>
            <span class="s1">&#39;quotechar&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
            <span class="s1">&#39;encoding&#39;</span><span class="p">:</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">}</span>

<span class="n">rhu</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;input/rhu.csv.gz&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">csv_opts</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;hashid&#39;</span><span class="p">]))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">rhu</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;hashid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span>

<span class="n">data_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rhu</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">data_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;hashid&#39;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2457 entries, 0 to 2456
Data columns (total 10 columns):
 #   Column             Non-Null Count  Dtype
---  ------             --------------  -----
 0   name               2457 non-null   object
 1   alien_#            2457 non-null   object
 2   date_in            2457 non-null   object
 3   date_out           2457 non-null   object
 4   total_days         2457 non-null   int64
 5   initial_placement  2457 non-null   object
 6   placement_reason   2457 non-null   object
 7   disc_seg           2457 non-null   object
 8   release_reason     2457 non-null   object
 9   hashid             2457 non-null   object
dtypes: int64(1), object(9)
memory usage: 192.1+ KB
None
</pre></div>

<p>Here we display the first five records in the dataset (excluding <code>hashid</code> field):</p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>alien_#</th>
      <th>date_in</th>
      <th>date_out</th>
      <th>total_days</th>
      <th>initial_placement</th>
      <th>placement_reason</th>
      <th>disc_seg</th>
      <th>release_reason</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>(b)(6),(b)(7)(c )</td>
      <td>(b)(6),(b)(7)(c )</td>
      <td>1/3/2015</td>
      <td>1/5/2015</td>
      <td>20</td>
      <td>pending hearing</td>
      <td>refusing staff orders</td>
      <td>N</td>
      <td>release to gen pop</td>
    </tr>
    <tr>
      <td>(b)(6),(b)(7)(c )</td>
      <td>(b)(6),(b)(7)(c )</td>
      <td>1/10/2015</td>
      <td>1/12/2015</td>
      <td>294</td>
      <td>pending hearing</td>
      <td>assault</td>
      <td>N</td>
      <td>release from custody</td>
    </tr>
    <tr>
      <td>(b)(6),(b)(7)(c )</td>
      <td>(b)(6),(b)(7)(c )</td>
      <td>1/12/2015</td>
      <td>1/16/2015</td>
      <td>8</td>
      <td>pending hearing</td>
      <td>disrupting facility operations</td>
      <td>Y</td>
      <td>released to medical</td>
    </tr>
    <tr>
      <td>(b)(6),(b)(7)(c )</td>
      <td>(b)(6),(b)(7)(c )</td>
      <td>1/13/2015</td>
      <td>1/29/2015</td>
      <td>3</td>
      <td>pending hearing</td>
      <td>assault</td>
      <td>Y</td>
      <td>release to gen pop</td>
    </tr>
    <tr>
      <td>(b)(6),(b)(7)(c )</td>
      <td>(b)(6),(b)(7)(c )</td>
      <td>1/14/2015</td>
      <td>2/6/2015</td>
      <td>4</td>
      <td>security risk</td>
      <td>(b)(6), (b)(7)(C), (b)(7)(E)</td>
      <td>N</td>
      <td>release from custody</td>
    </tr>
  </tbody>
</table>

<h2>Dates and total days calculation</h2>
<p>Inspection of the original Excel file shows that the <code>Total days</code> column values are often incorrect, based on a missing cell formula. For example, on the "2020" spreadsheet tab, the <code>Total days</code> column values are integers which only occasionally align with calculated placement length based on the <code>Date in</code> and <code>Date out</code> columns. However, additional spreadsheet rows at the bottom of the sheet not containing values in other fields contain an Excel formula ("=(D138-C138)+1") which should have been used to calculate these values. Comparing calculated stay lengths with reported <code>Total days</code> suggests that this formula was not updated consistently, causing fields to become misaligned. Additionally, the "2015" spreadsheet tab includes many <code>Total days</code> values equal to "1", suggesting that the formula was applied incorrectly or with missing data.</p>
<p>We can recalculate actual stay lengths based on the formula cited above (inclusive of start days, with stays of less than one day calculated as "1"); or with the formula used for the "SMU" records above (exclusive of start days, with stays of less than one day calculated as "0"), for more consistent comparison with other datasets.</p>
<p>The above issue raises the possibility that other fields in addition to <code>Total days</code> may be misaligned in the original dataset. One fact mitigating this possibility is that no <code>Date out</code> values predate associated <code>Date in</code> values. We can also look more closely at qualitative fields to make an educated guess as to the data quality: for example, do <code>intial_placement</code> values suggesting disciplinary placements align with <code>placement_reason</code> values also consistent with disciplinary placements? However, we do not intend to use this dataset for detailed qualitative analysis; of most interest are total segregation placements and segregation stay lengths.</p>

<div class="highlight"><pre><span></span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_in&#39;</span><span class="p">])</span>
<span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_out&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_out&#39;</span><span class="p">])</span>

<span class="c1"># As noted above, no `date_out` values predate associated `date_in` values:</span>

<span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_in&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_out&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>

<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_in&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_out&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
count                    2457
unique                   1237
top       2019-01-08 00:00:00
freq                       12
first     2015-01-03 00:00:00
last      2020-05-28 00:00:00
Name: date_in, dtype: object

count                    2457
unique                   1105
top       2017-06-13 00:00:00
freq                       11
first     2015-01-05 00:00:00
last      2020-05-29 00:00:00
Name: date_out, dtype: object
</pre></div>

<p>Here we recalculate the total days field based on the first day inclusive formula in the original Excel spreadsheet ("=(D138-C138)+1"):</p>

<div class="highlight"><pre><span></span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;total_days_calc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_out&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_in&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">compare_pct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;total_days_calc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;total_days&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">rhu</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;total_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;total_days_calc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
count    2457.000000
mean       13.877900
std        37.544802
min         1.000000
25%         2.000000
50%         4.000000
75%        11.000000
max       694.000000
Name: total_days, dtype: float64

count    2457.000000
mean       15.077737
std        38.142819
min         1.000000
25%         3.000000
50%         5.000000
75%        12.000000
max       694.000000
Name: total_days_calc, dtype: float64
</pre></div>

<p>Only 7.86% of original <code>total_days</code> values match their respective recalculated stay lengths in <code>total_days_calc</code>.</p>
<p>However, note that the above summary statistics for the original field (<code>total_days</code>) are very similar to the recalculated field (<code>total_days_calc</code>), suggesting that most values are present in the dataset but misaligned.</p>
<p>Therefore, we will conclude that it is correct to recalculate the <code>total_days</code> field. Instead of the first day inclusive formula suggested in the original dataset, here we will use a first day exclusive formula, where placements starting and ending on the same day have length 0. While this risks underestimating placement lengths represented in the dataset, it is more consistent with the calculation of placement lenghts in the SMU and SRMS datasets:</p>

<div class="highlight"><pre><span></span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;total_days&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_out&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;date_in&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">rhu</span> <span class="o">=</span> <span class="n">rhu</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;total_days_calc&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;total_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
count    2457.000000
mean       14.077737
std        38.142819
min         0.000000
25%         2.000000
50%         4.000000
75%        11.000000
max       693.000000
Name: total_days, dtype: float64
</pre></div>

<p>Annual median and mean placement lengths are relatively consistent, showing an apparent decrease during the first few months of 2020, possibly explained by incomplete placements excluded from this dataset:</p>

<div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">rhu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date_in&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">)])</span>

<span class="n">rhu_annual_med</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;total_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="n">rhu_annual_avg</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;total_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">rhu_annual_med</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">rhu_annual_avg</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre>
date_in
2015-01-01    4.0
2016-01-01    4.0
2017-01-01    4.0
2018-01-01    4.0
2019-01-01    4.0
2020-01-01    3.0
Freq: AS-JAN, Name: total_days, dtype: float64

date_in
2015-01-01    14.374631
2016-01-01    12.013761
2017-01-01    16.978927
2018-01-01    13.826690
2019-01-01    14.343681
2020-01-01     8.848485
Freq: AS-JAN, Name: total_days, dtype: float64
</pre></div>

<p>Total placement counts per calendar year (note data for 2020 is incomplete):</p>

<div class="highlight"><pre><span></span><span class="n">rhu_total_annual</span> <span class="o">=</span> <span class="n">rhu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date_in&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">)])[</span><span class="s1">&#39;hashid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">rhu_total_annual</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre>
date_in
2015-01-01    339
2016-01-01    436
2017-01-01    522
2018-01-01    577
2019-01-01    451
2020-01-01    132
Freq: AS-JAN, Name: hashid, dtype: int64
</pre></div>

<p>Stays over 14 days must be reported to ICE SRMS; here we flag long placements and calculate as a percent of total placements per year. The lack of unique identifiers makes it impossible to track cases of individuals in segregation for a total of 14 non-consecutive days during any 21 day period. Inconsistencies and lack of information in <code>placement_reason</code> make it a poor candidate for flagging placements involving individuals with special vulnerabilities. We note an increasing proportion and absolute number of long placements during 2017-2019:</p>

<div class="highlight"><pre><span></span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;long_stay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;total_days&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">14</span>
<span class="n">long_stays_annual</span> <span class="o">=</span> <span class="n">rhu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date_in&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">)])[</span><span class="s1">&#39;long_stay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">long_stays_annual</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">long_stays_annual</span> <span class="o">/</span> <span class="n">rhu_total_annual</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre>
date_in
2015-01-01     52.0
2016-01-01     73.0
2017-01-01    102.0
2018-01-01    129.0
2019-01-01    103.0
2020-01-01     21.0
Freq: AS-JAN, Name: long_stay, dtype: float64

date_in
2015-01-01    0.153392
2016-01-01    0.167431
2017-01-01    0.195402
2018-01-01    0.223570
2019-01-01    0.228381
2020-01-01    0.159091
Freq: AS-JAN, dtype: float64
</pre></div>

<p>There are 12 <code>initial_placement</code> values. These closely correspond to the <code>placement_reason</code> values cited in the SRMS datasets (see <a href="nwdc-srms-2.html">SRMS 2</a>, <a href="natl-srms.html">National SRMS Comparison</a> appendices). The most common <code>initial_placement</code> values (not correcting for some minor spelling variations) are:</p>

<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;initial_placement&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre>
pending hearing       1161
security risk          543
medical                393
protective custody     331
disciplinary             9
Name: initial_placement, dtype: int64
</pre></div>

<p>There are 319 <code>placement_reason</code> values, including some redacted fields. Below we print the 10 most common values:</p>

<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;placement_reason&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre>
fighting                        398
medical overflow                209
fears general population        209
(b)(6), (b)(7)(c), (b)(7)(e)    163
assault                          93
assault on detainee              69
medical isolation overflow       67
sharpened instrument             58
threats to staff                 43
threat to others                 39
Name: placement_reason, dtype: int64
</pre></div>

<p>There are 54 <code>release_reason</code> values (not correcting for spelling or other variations). Below we print the 10 most common values:</p>

<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;release_reason&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre>
release to population          408
release to gen pop             344
release from custody           313
release to medical             227
transfer facility              172
disc time complete             168
discipline time complete       130
time served                    121
not guilty                     115
time served - release to gp     80
Name: release_reason, dtype: int64
</pre></div>

<p>The field <code>disc_seg</code> flags disciplinary segregation placements, which require a hearing process; versus administrative segregation placements. The majority of placements are administrative. Average stay lengths for disciplinary and administrative are similar; though median </p>

<div class="highlight"><pre><span></span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;disc_seg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;disc_seg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;disc_seg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Proportion:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="p">[</span><span class="s1">&#39;disc_seg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Count per year:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date_in&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">))[</span><span class="s1">&#39;disc_seg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Stay length by category:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date_in&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;disc_seg&#39;</span><span class="p">])[</span><span class="s1">&#39;total_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Annual median stay length by category:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">rhu</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date_in&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS&#39;</span><span class="p">),</span> <span class="s1">&#39;disc_seg&#39;</span><span class="p">])[</span><span class="s1">&#39;total_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>

<div class="highlight"><pre>
Proportion:
N    0.756614
Y    0.243386
Name: disc_seg, dtype: float64

Count per year:
date_in     disc_seg
2015-01-01  N           241
            Y            98
2016-01-01  N           339
            Y            97
2017-01-01  N           411
            Y           111
2018-01-01  N           432
            Y           145
2019-01-01  N           339
            Y           112
2020-01-01  N            97
            Y            35
Name: disc_seg, dtype: int64

Stay length by category:
           count       mean        std  min  25%   50%   75%    max
disc_seg
N         1859.0  13.866595  41.405676  0.0  1.0   3.0   7.0  693.0
Y          598.0  14.734114  25.474417  1.0  6.0  10.0  19.0  412.0

Annual median stay length by category:
date_in     disc_seg
2015-01-01  N           14.514523
            Y           14.030612
2016-01-01  N           11.687316
            Y           13.154639
2017-01-01  N           17.530414
            Y           14.936937
2018-01-01  N           12.780093
            Y           16.944828
2019-01-01  N           14.268437
            Y           14.571429
2020-01-01  N            7.783505
            Y           11.800000
Name: total_days, dtype: float64
</pre></div>

<p>Next section: <a href="smu-rhu-srms-compare.html">Data Appenix 2. Comparison of GEO Group and ICE SRMS Datasets</a></p>
<p><a href="index.html">Back to Data Appendix Index</a></p>
<!---

---

## Notes

<a href="#_ftnref1" name="_ftn1"><sup>[1]</sup></a> US DOJ attorneys for ICE specified that the terms "Special Management Unit" and "Restricted Housing Unit" are interchangeable and identify the same locations.

-->
    <HR/>
    <div class="footer">
      <p>Published from <a href="https://github.com/UWCHR/nwdc-seg/blob/master/write/src/smu-rhu.pmd">src/smu-rhu.pmd</a>
    using <a href="http://mpastell.com/pweave">Pweave</a> 0.30.3
    on 28-11-2020.<p></div>

            </div>
        </div>
    </div>
  </BODY>
</HTML>
